 @{
     Layout = "/Areas/MBShop/Themes/Y1/Views/Shared/_NoFootLayout.cshtml";
     ViewBag.Title = "个人中心-修改信息";
 }
 @model YSWL.MALL.Model.Members.UsersExpModel  
<script src="/Areas/MBShop/Themes/Y1/Content/Scripts/UserCenter/updateuserinfo.js" type="text/javascript"></script>

<style type="text/css">
    select {
    width: 80px;
}
</style>
<body class="bg">
<header class="m_header">
    <div class="">
        <div class="m_header_bar">
            <div class="m_icon_goback icon" onclick="javascript:history.go(-1);">
                <span></span>
            </div>
            <p class="m_header_title">个人资料</p>
        </div>
    </div>
</header>

@if (Model != null)
{
    <div class="">
        <div class="data_item">
            <label class="data_item_label" for="name">用户名</label>
            <input disabled="disabled"  type="text" class="input-lg data_input input_disabled1" value="@Model.UserName" id="name">
        </div>
        <div class="data_item">
            <label class="data_item_label" for="name">真实姓名</label>
            <input disabled="disabled" type="text" class="input-lg data_input input_disabled1" value="@Model.TrueName" id="txtTrueName">
        </div>
        <div class="data_item" style="display:none">
            <label class="data_item_label" for="name" >公司</label>
            <input disabled="disabled" type="text" class="input-lg data_input input_disabled1" value="云商未来" id="company">
        </div>
        <div class="data_item" style="display:none">
            <label class="data_item_label" for="position">职位</label>
            <input disabled="disabled" type="text" class="input-lg data_input input_disabled1" value="经理" id="position">
        </div>
        <div class="data_item">
            <label class="data_item_label" for="phonenum">手机</label>
            <input disabled="disabled" type="text" class="input-lg data_input input_disabled1" value="@Model.Phone" id="txtPhone">
        </div>
        <div class="data_item">
            <label class="data_item_label" for="email">邮箱</label>
            <input disabled="disabled" type="text" class="input-lg data_input input_disabled1" value="@Model.Email" id="txtEmail">
        </div>
        <div class="data_item">
            <label class="data_item_label" for="qq">QQ</label>
            <input disabled="disabled" type="text" class="input-lg data_input input_disabled1" value="@Model.QQ" id="txtQQ">
        </div>
    </div>
}

<a href="javascript:void(0);" onclick="edit()" id="editButton">
    <nav class="navbar-fixed-bottom nav_bottom_focus bg_yellow">
        <span class="font_white">编辑</span>
    </nav>
</a>

<a href="javascript:void(0);" onclick="submit()" id="submitButton" style="display:none">
    <nav class="navbar-fixed-bottom nav_bottom_focus bg_blue">
        <span class="font_white">保存</span>
    </nav>
</a>
    <script>
    //启用编辑
    function edit()
    {
        $(".input-lg").removeAttr("disabled");
        $(".input-lg").removeClass("input_disabled1");
        $("#editButton").attr("style", "display:none");
        $("#submitButton").attr("style", "display:display");
        $("#name").attr("disabled", "true");
        $("#name").addClass("input_disabled1");
    }
    function cancel_edit() {
        $(".input-lg").addClass("input_disabled1");
        $(".input-lg").attr("disabled", "disabled");
        $("#editButton").attr("style", "display:display");
        $("#submitButton").attr("style", "display:none");
    }

    function submit() {

        var truename = $.trim($("#txtTrueName").val());
        if (truename.length < 1)
        {
            AlertWarning("真实姓名不能为空!");
            return;
        }
        var email = $.trim($("#txtEmail").val());
        if (email!="")
        {
            if(!checkemail())
            {
                return;
            }
        }

        var phone = $.trim($("#txtPhone").val());
        var qq = $.trim($("#txtQQ").val());

        $.ajax({
            url: $YSWL.BasePath + "u/UpdateUserInfo",
            type: 'post',
            dataType: 'json',
            timeout: 10000,
            async: false,
            data: {
                Action: "post",
                TrueName: truename,
                Email: email,
                Phone: phone,
                QQ:qq
            },
            success: function (JsonData) {

                switch (JsonData.STATUS) {
                    case "SUCC":
                        AlertSuccess("修改成功！");
                        cancel_edit();
                        setTimeout((window.location.href=$YSWL.BasePath+"u") , 4000);
                        break;
                    case "FAIL":
                        AlertWarning("修改失败！");
                        cancel_edit();
                        break;
                    default:
                        ShowServerBusyTip("服务器没有返回数据，可能服务器忙，请稍候再试！");
                        break;
                }
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
                ShowServerBusyTip("服务器没有返回数据，可能服务器忙，请稍候再试！");
            }

        });

    };

    function checkemail() {
        /*验证用户邮箱开始*/
        var emailVal = $.trim($('#txtEmail').val());
        if (emailVal.length > 100) {
            AlertWarning("邮箱长度不能超过100个字符串！");
            return false;
        } else if (!/^\w+([-+.]\w+)*@@\w+([-.]\w+)*\.\w+([-.]\w+)*/.test(emailVal)) {
            AlertWarning("请填写有效的email地址");
            return false;
        } else {
            $("#emailTip").removeClass("red").addClass("tipClass").html("&nbsp;");
            return true;
        }
        /*验证用户邮箱结束*/
    }
</script>
    </body>
    


