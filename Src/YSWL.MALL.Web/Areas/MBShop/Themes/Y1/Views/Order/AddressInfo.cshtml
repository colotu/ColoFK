@{
    Layout = "~/Areas/MBShop/Themes/Y1/Views/Shared/_NoFootLayout.cshtml";
}
@section head{
    <script src="/Scripts/jquery/jquery.guid.js" type="text/javascript"></script>
}
@model YSWL.MALL.Model.Shop.Shipping.ShippingAddress
  	<!--START HEADER-->
<header class="m_header">
    <div class="">
        <div class="m_header_bar">
            <div class="m_icon_goback icon" onclick="history.go(-1);">
                <span></span>
            </div>
            <p class="m_header_title">收货人信息</p>
        </div>
    </div>
</header>
<!-- END HEADER -->
<div class="menu_list">
@using (Html.BeginForm("SubmitAddressInfo", "Order", FormMethod.Post, new { id = "FormSubmitAddress", area = "MShop" }))
{
    @Html.HiddenFor(m => m.ShippingId)
    @Html.HiddenFor(m => m.UserId)
    @Html.TextBoxFor(m => m.ShipName, new { maxlength = "20" , placeholder= "收货人姓名",Class="input-lg reg_input" })
    <span class="region_box">
            @Html.HiddenFor(m => m.RegionId, new { id = "hfSelectedNode" })
            <script src="/Scripts/jquery/maticsoft.selectregion.js" handle="/RegionHandle.aspx"   isnull="true" type="text/javascript"></script>
    </span>
    @Html.TextBoxFor(m => m.Address, new {placeholder = "详细地址", Class = "input-lg reg_input" })

    @Html.TextBoxFor(m => m.CelPhone, new { maxlength = "11", placeholder = "手机号", Class = "input-lg reg_input" })

    @Html.TextBoxFor(m => m.EmailAddress, new { placeholder = "邮箱", Class = "input-lg reg_input" })
}
</div>
<!--底部悬浮-->
<nav class="navbar-fixed-bottom nav_bottom_focus bg_blue">
    <a href="javascript:;"  onclick=" Save_Consignee(this) " >
        <span class="font_white">保存收货地址</span>
    </a>
</nav>
 @section foot{
<script type="text/javascript">
    $("body").addClass("bg");
   
    function Save_Consignee(sender) {
        var shipName = $("#ShipName").val();
        if (shipName == "") {
            AlertWarning("请填写收货人");
            return;
        }
        var regionId = parseInt($("#hfSelectedNode").val());
        if (regionId == 0 || $("#hfSelectedNode").val() == "") {
            AlertWarning("请选择所在地区");
            return;
        }
        debugger;
        if ($(".region_box").find('select').length < 3) {
            AlertWarning("请选择完整地区信息");
            return;
        }
        var reState = true;
        $(".region_box").find('select').each(function () {
            var text = $(this).val();
            if (text.length < 1) {
                AlertWarning("请选择完整地区信息");
                reState = false;
                
            }
        });
        if (!reState) {
            return;
        }
        var address = $("#Address").val();
        if (address == "") {
            AlertWarning("请填写详细地址");
            return;
        }
        var celPhone = $("#CelPhone").val();
        if (celPhone == "") {
            AlertWarning("请填写手机号码");
            return;
        }
        $(sender).hide();
        $(sender).next().show();
        var form = $('#FormSubmitAddress');
        $.post(
            form.get(0).action,
            form.serialize(),
            function (data) {
                if (data == "True") {
                    window.location.href = $YSWL.BasePath + "Order/SubmitOrder";
                } else {
                    AlertWarning("服务器繁忙，请稍候再试！");
                }
            }
        );
    }
</script>
 }