@using Webdiyer.WebControls.Mvc
@{
    Layout = "/Areas/MBShop/Themes/Y1/Views/Shared/_BaseLayout.cshtml";
}
<!--START MAIN-WRAPPER-->
<script src="/Scripts/jquery/maticsoft.waterfall.js"></script>
<div class="main-wrapper">
    <!--START HEADER-->
    <header class="m_header">
        <div class="navbar-fixed-top">
            <div class="m_header_bar">
                <div class="m_icon_goback icon" onclick="history.go(-1);">
                    <span></span>
                </div>
                <p class="m_header_title">促销商品</p>
                
            </div>
        </div>
    </header>
    <div class="mt44 mb50" id="J_lazyload" >
        @if (Model != null && Model.Count > 0)
        {
            foreach (var item in Model)
            {
                <div class="list_box2">
                    <div class="">
                        <div class="list_thumb">
                            <a href="@(ViewBag.BasePath)p/d/@item.ProductId" class="">
                                <img class="" src="@YSWL.MALL.Web.Components.FileHelper.GeThumbImage(item.ThumbnailUrl1, "T81X81")">
                            </a>
                            @switch ((int)item.ruleType)
                    {
                            case 0:
                                    <div class="prod_tip bg_red">
                                        打折
                                    </div>
                                    break;
                                case 1:
                                    <div class="prod_tip bg_blue">
                                        减价
                                    </div>
                                    break;
                                case 2:
                                    <div class="prod_tip bg_green">
                                        直降
                                    </div>
                                    break;
                                default:
                                    break;
                            }
                        </div>
                        <div class="list_descriptions">
                            <div class="product_name">@item.ProductName</div>
                            <span class="price_red">￥@item.LowestSalePrice.ToString("f")</span>
                        </div>
                    </div>
                    @{
                        if (item.SalesType == 1 && item.SaleStatus == 1 && ViewBag.IsMultiDepot)
                        {
                            <div class="cart icon" onclick="dialogShow(@item.ProductId, @item.SupplierId, '@item.ThumbnailUrl1',@item.SupplierId,@item.ProductId)">
                                <span></span>
                            </div>
                        }
                        else
                        {
                            <div class="cart icon" onclick="dialogShow(@item.ProductId,@item.SupplierId,'@item.ThumbnailUrl1')">
                                <span></span>
                            </div>
                        }
                    }
                </div>
            }
        }
        else
        {
            <div class="shp_cart_wrap mt44 mb50">
                <div class="emptycart wrap" style="display:block">
                    <div class="shp_cart_empty">
                        <div class="order_empty">
                            <div class="search_empty_pic icon">
                                <span></span>
                            </div>
                            <div class="empty_warning_text">
                                暂无促销商品
                            </div>
                        </div>
                    </div>
                </div>
            </div>



         }
        </div>
        <!-- END HEADER -->

    </div>

<script type="text/javascript">
    $(function () {
        $('body').addClass('bg');

                           waterFall.init({
                               //Ajax请求参数
                               AjaxOptions: {
                                   //Ajax请求参数
                                   Params: { ajaxViewName: "_SalesRulePWaterfall" },
                                   //Params:@Html.Raw(ViewBag.DataParam),
                                   //Ajax请求URL
                                   DataURL: "@(ViewBag.BasePath)Product/SalesRuleP"
                               },
                               //瀑布流起始索引记录器 - 用于累计
                               CurrentAjaxStartIndexHF: $('#hfCurrentPageAjaxStartIndex'),
                               //瀑布流起始索引
                               StartIndex:$('#hfCurrentPageAjaxStartIndex').val() ? parseInt($('#hfCurrentPageAjaxStartIndex').val()) : 0,
                               //瀑布流结束索引
                               EndIndex: $('#hfCurrentPageAjaxEndIndex').val() ? parseInt($('#hfCurrentPageAjaxEndIndex').val()) : 0,

                               //分页容器
                               PagedContainer: $('.in_pages'),
                               //列容器ID前缀
                               ColumnFirstId: "J_lazyload",
                               //列数
                               ColumnNumber: 0,RowNumber: 3
                           });
                       });
</script>
<!--加入购物车弹窗-->
    @Html.Partial("/Areas/MBShop/Themes/Y1/Views/Partial/_AddCart.cshtml")
    @section foot{
        <script src="/Scripts/jqueryui/jquery-ui-1.9.2.custom.js" type="text/javascript"></script>
        <script src="/Areas/MBShop/Themes/Y1/Content/Scripts/productdetail.js?v=1.0"></script>
    }
