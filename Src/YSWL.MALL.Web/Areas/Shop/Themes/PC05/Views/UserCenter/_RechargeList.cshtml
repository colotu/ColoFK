@using YSWL.Common;
@using Webdiyer.WebControls.Mvc
@model PagedList<YSWL.MALL.Model.Pay.RechargeRequest>

<div class="user_rechargedetial user_detialclear">
    <a href="javascript:;" item="BalanceDetList">收支明细</a>
    <a href="javascript:;" class="curr">充值明细</a>
    <a href="javascript:;" item="DrawDetList">提现明细</a>
</div>
                <table width="100%" border="0" class="user_dingdan user_balancelist" cellspacing="0" cellpadding="0">
              <tr>
                  <th  style="width:145px;">时间</th>
                  <th>充值单号</th>
                  <th>充值金额</th>
                  <th>状态</th>
                  <th>操作</th>
              </tr>
              @if (Model != null)
              {
                  foreach (var item in Model)
                  {
                  <tr id="tr_@(item.RechargeId)">
                      <td height="40"  class="bor">
                          @item.TradeDate.ToString("yyyy-MM-dd HH:mm:ss")
                      </td>
                      <td  class="bor">
                          @item.RechargeId
                      </td>
                      <td  class="bor">
                          @item.RechargeBlance.ToString("F")
                      </td>
                      <td   class="bor status" >
                          @(item.Status == 0 ? "未支付" : "已支付")
                      </td>
                      <td style="text-align: center;"  >
                         @if (item.Status == 0)
                         {
                             <a style="cursor: pointer;" href="javascript:;" onclick="PayAccount(@item.RechargeId)">支付</a><br />
                             <a style="cursor: pointer;" onclick="delRech(@item.RechargeId,@item.Status)">取消</a>
                         }
                      </td>
                  </tr>
                  }
              }
           
           </table>
    
 @if (Model != null)
 {
<!-- FansList BEGIN -->
       <div style="margin-top: 20px;">
    @Ajax.Pager(Model, new PagerOptions
{
    ShowDisabledPagerItems = false,
    AlwaysShowFirstLastPageNumber = true,
    PageIndexParameterName = "pageIndex",
    NumericPagerItemCount = 10,
    CurrentPagerItemTemplate = "<a class=\"shoye\">{0}</a>",
    CssClass = "page",
    FirstPageText = "首页",
    PrevPageText = "上一页",
    NextPageText = "下一页",
    LastPageText = "尾页"
}).AjaxOptions(a => a.SetUpdateTargetId("divdetaillist"))
            </div> 
 }

<script>
    $(function() {
        $('.status:contains("未支付")').addClass('tdstatusno');
        $('.status:contains("已支付")').addClass('tdstatusok');

    });

    var PayAccount = function (id) {
        if (id) {
            window.location.replace("/pay/account" + id);
        }
    };

    var delRech = function (id, states) {
        if (parseInt(states) == 0 && id) {
            $.ajax({
                url: $YSWL.BasePath + "UserCenter/DelRecharge",
                type: 'post',
                dataType: 'text',
                timeout: 10000,
                async: false,
                data: {
                    Action: "post",
                    Id: id
                },
                success: function (Data) {
                    switch (Data) {
                        case "False":
                            ShowFailTip("删除失败！");
                            break;
                        case "True":
                            ShowSuccessTip("删除成功！");
                            $('#tr_' + id).empty();
                            break;
                        default:
                            ShowServerBusyTip("服务器没有返回数据，可能服务器忙，请稍候再试！");
                            break;
                    }
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    ShowServerBusyTip("服务器没有返回数据，可能服务器忙，请稍候再试！");
                }
            });
        }
    };
   
</script>