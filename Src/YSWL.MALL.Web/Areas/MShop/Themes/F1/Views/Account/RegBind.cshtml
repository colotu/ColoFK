

 @{
     Layout = "/Areas/MShop/Themes/F1/Views/Shared/_BaseLayout.cshtml";
     ViewBag.Title = "微信用户绑定";
 }
 @model YSWL.MALL.ViewModel.Shop.RegisterModel
 
<script type="text/javascript">
    $(function () {
        //微信新用户绑定
        $("#btnRegBind").click(function () {
            var nick = $("#nickname").val();
            var returnUrl = $("#hfReturn").val();
            if (nick == "") {
                ShowFailTip("请输入用户昵称！");
            }
            $.ajax({
                url: $YSWL.BasePath + "Account/AjaxRegBind",
                type: 'post',
                dataType: 'text',
                timeout: 10000,
                async: false,
                data: {
                    Action: "post", NickName: nick
                },
                success: function (resultData) {
                    if (resultData == "1") {
                        ShowSuccessTip("绑定用户成功！");
                        if (returnUrl == "") {
                            location.href = returnUrl;
                        }
                        else {
                            location.href = $YSWL.BasePath + "u";
                        }
                    }
                    if (resultData == "2") {
                        ShowFailTip("该微信帐号已经绑定！");
                        if (returnUrl == "") {
                           
                            location.href = $YSWL.BasePath + "u";
                        }
                        else {
                            location.href = returnUrl;
                        }
                    }
                    if (resultData == "0") {
                        ShowFailTip("服务器繁忙，请稍候再试！");
                    }
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    ShowServerBusyTip("服务器繁忙，请稍候再试！");
                }

            });
        });
    })
</script>
 <div data-role="content" class="ui-content" role="main">
<div class="yy"><span id="diverror" style="margin-left:10px;margin-top:10px;" class="txterror"></span></div>
<div class="contact-info">
    <input id="hfReturn" type="hidden"  value="@ViewBag.ReturnUrl"/>
    <input id="chkAgreement"  type="checkbox" checked="checked" style="display: none"/>
         <span  class="tipClass"> &nbsp; </span>
        
        <div> @Html.TextBoxFor(m => m.NickName, new { id = "nickname", Class = "ui-input-text ui-body-c", placeholder = "请输入昵称" }) <br />
            <div id="divNicknameTip"  class="txterror tipClass" >
                <span   class="txterror">&nbsp; @Html.ValidationMessageFor(m => m.NickName) @ViewBag.hasnickname</span>
            </div></div>
        
        
       
 			
           <a data-role="button" href="javascript:;" rel="external" id="btnRegBind"  data-theme="b" data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" class="ui-btn ui-btn-up-b ui-shadow ui-btn-corner-all">
               <span class="ui-btn-inner"><span class="ui-btn-text">微信登录</span></span>
           </a>
  
 
</div>
 </div>