@{
    Layout = "~/Areas/MShop/Themes/F1/Views/Shared/_BaseLayout.cshtml";
  
}
@section head{
    <script src="/Scripts/jquery/jquery.guid.js" type="text/javascript"></script>
}
@model YSWL.MALL.Model.Shop.Shipping.ShippingAddress
 
  
<div data-role="content" class="ui-content" role="main">
    <div class="contact-info step-content" >												
        <ul data-role="listview" data-inset="true" data-theme="d" class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
            <li data-role="list-divider" role="heading" class="ui-li ui-li-divider ui-bar-b ui-first-child">修改/添加收货人信息</li>
            <li style="padding: 5px 10px 5px 10px" class="ui-li ui-li-static ui-btn-up-d ui-last-child" id="consignee">
                
                @using (Html.BeginForm("SubmitAddressInfo", "Order", FormMethod.Post, new { id = "FormSubmitAddress", area = "MShop" }))
                {    
                    @Html.HiddenFor(m => m.ShippingId)
                    @Html.HiddenFor(m => m.UserId)
                    <table style="padding: 0; margin: 0; width: 100%;" >
                        <tbody class="consignee-form" id="consignee-form">
                 
                            <tr>
                                <td width="80px"  ><label  class="ui-input-text">收&nbsp;货&nbsp;人：</label></td>
                                <td>
                                    <input type="hidden" id="consignee_form_id" name="consigneeParam.id">
                                    <input type="hidden" id="consignee_type" name="consigneeParam.type">
                                    @Html.TextBoxFor(m => m.ShipName, new { maxlength = "20" ,Class = "ui-input-text ui-body-c" })
                                </td>
                            </tr>
                  	
                            <tr>
                                <td width="80px" ><label  class="ui-input-text">所在地区：</label></td>
                                <td>
                                    <div id="span_area" style="break: break-all;">
                                        @Html.HiddenFor(m => m.RegionId, new { id = "hfSelectedNode" })
                                        <script src="/Scripts/jquery/maticsoft.selectregion.js" handle="/RegionHandle.aspx"
                                                isnull="true" type="text/javascript"></script>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td width="80px" ><label   class="ui-input-text">详细地址：</label></td>
                                <td>
                                    @Html.TextBoxFor(m => m.Address, new { Class = "ui-input-text ui-body-c" })
                                </td>
                            </tr>
                            <tr>
                                <td width="80px"><label class="ui-input-text">手机号码：</label></td>
                                <td>
                                    @Html.TextBoxFor(m => m.CelPhone, new { maxlength = "11", Class = "ui-input-text ui-body-c" }) 
                                </td>
                            </tr>
                            <tr>
                                <td width="80px" ><label class="ui-input-text">邮&#12288;&#12288;箱：</label></td>
                                <td>
                                    @Html.TextBoxFor(m => m.EmailAddress,new{ Class = "ui-input-text ui-body-c" }) 
                                </td>
                            </tr>
                        
                           
                        </tbody></table>
        
         
                    
                }
                
        
            </li>
        </ul>
        <div>
          <a data-role="button" href="javascript:;"  onclick=" Save_Consignee(this) "   data-theme="b" data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" class="ui-btn ui-btn-up-b ui-shadow ui-btn-corner-all">
              <span class="ui-btn-inner"><span class="ui-btn-text">确认收货地址</span></span>
          </a>
          <div class="loading loading-1" style="display: none">
                <b></b>正在提交信息，请等待！</div>
       </div>
    </div>
 
 
</div>
 
<script type="text/javascript">
    function Save_Consignee(sender) {
        var shipName = $("#ShipName").val();
        if (shipName == "") {
            ShowFailTip("请填写收货人");
            return;
        }
        var regionId = parseInt($("#hfSelectedNode").val());
        if (regionId == 0 || $("#hfSelectedNode").val() == "") {
            ShowFailTip("请选择所在地区");
            return;
        }
        var address = $("#Address").val();
        if (address == "") {
            ShowFailTip("请填写详细地址");
            return;
        }
        var celPhone = $("#CelPhone").val();
        if (celPhone == "") {
            ShowFailTip("请填写手机号码");
            return;
        }
        $(sender).hide();
        $(sender).next().show();
        var form = $('#FormSubmitAddress');
        $.post(
            form.get(0).action,
            form.serialize(),
            function (data) {
                if (data == "True") {
                    window.location.href = $YSWL.BasePath + "Order/SubmitOrder";
                } else {
                    ShowFailTip("服务器繁忙，请稍候再试！");
                }
                //window.location.hash = "consigneeFocus";
                // Edit_Payment(null, true);
            }
        );
    }
</script>
