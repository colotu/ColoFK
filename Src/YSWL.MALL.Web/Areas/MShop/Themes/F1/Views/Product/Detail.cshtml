@using YSWL.MALL.Model.Shop.Products
@model YSWL.MALL.ViewModel.Shop.ProductModel
@{
    Layout = "/Areas/MShop/Themes/F1/Views/Shared/_BaseLayout.cshtml";
} 
@section head{ 
<script src="/Areas/MShop/Themes/F1/Content/Scripts/productdetail.js" type="text/javascript"></script>
    <script src="/Areas/MShop/Themes/F1/Content/Scripts/SKU.js" type="text/javascript"></script>
    <script src="/Scripts/jquery/maticsoft.img.min.js" type="text/javascript"></script>
<script src="/Scripts/jquery.cookie.js" type="text/javascript"></script>
   <script type="text/javascript">
pagename = "product_detail";
       $(function () {
            var width = $(window).width()-20;
            $.scaleLoad('#imgdetail', width, 1280);
            $.scaleLoad('#sitead_index', 350, 350);
            GetPvCount(@Model.ProductInfo.ProductId);
	    
	    
	    if(@Model.ProductInfo.SalesType==3){
          $('#btnAddToCart').attr('disabled', 'disabled').addClass('addCart-gray').text('赠品不出售!').attr('itemid','');
          $('#iteminfo #divBuyInfo').hide();
          $('#iteminfo #divSelectInfo').empty();
        }
        if (@Model.ProductInfo.SaleStatus !== 1) {
          $('#btnAddToCart').attr('disabled', 'disabled').addClass('addCart-gray').text('非常抱歉, 此商品已下架!').attr('itemid','');
          $('#iteminfo #divBuyInfo').hide();
          $('#iteminfo #divSelectInfo').empty();
        }
        });
       var GetPvCount = function (pid) {
        $.ajax({
            url: "@(ViewBag.BasePath)Product/GetPvCount",
            type: 'post',
            dataType: 'json',
            timeout: 10000,
            data: {
                pid: pid
            },
            success: function (jsondata) {
                if (jsondata.STATUS == "SUCCESS") {
                    //jsondata.DATA; 将访问数展示到页面上  预留 
                }
            },
            error: function (messsage) {
                alert(messsage);
            }
        });

    };
</script> 
}
<div data-role="content" class="ui-content font_family_sans" role="main">
@if (Model != null)
{
 <input id="hdProductId" type="hidden"  value="@Model.ProductInfo.ProductId"/>
    <input id="hdsuppId"   type="hidden" value="@Model.ProductInfo.SupplierId"/>
    <h3 id="foodname">@Model.ProductInfo.ProductName</h3>
    <!--图片轮换开始-->
   <div class="sitead">
        <div id="sitead_index" class="detail" style="overflow: hidden;">
            @if (Model != null && Model.ProductImages != null)
            {
                int i = 1;
                foreach (ProductImage productImage in Model.ProductImages)
                {   <a style="width: 100%; height: 100%; float: left;"  href="javascript:;" rel="external">
                    <img item="@YSWL.MALL.Web.Components.FileHelper.GeThumbImage(productImage.ThumbnailUrl1, "T350X350_")"  alt="@i" class="foodimage" src="@YSWL.MALL.Web.Components.FileHelper.GeThumbImage(productImage.ThumbnailUrl1, "T350X350_")"/>
                    </a>
                    i++;
                }
            }
        </div>
        <div id="sitead_indexdots" class="dots" style="height: 25px;">
        </div>
        <script type="text/javascript"  src="/Areas/MShop/Themes/F1/Content/Scripts/jq.mobi.js"></script>
        <script type="text/javascript"  src="/Areas/MShop/Themes/F1/Content/Scripts/jq.web.js"></script>
        <script type="text/javascript">
            var sitead;
            function sitead_carouselindex() {
                sitead = $$("#sitead_index").carousel({
                    pagingDiv: "sitead_indexdots",
                    pagingCssName: "sitead_paging",
                    pagingCssNameSelected: "sitead_paging_selected",
                    preventDefaults: false
                });
            }
            if ($('#sitead_index').children('a').length > 0) {//判断一下 有内容时 才执行
                window.setTimeout(function () {
                    sitead_carouselindex();
                }, 200);
            }
        </script>
    </div> 
    <!--图片轮换结束--->
    
 
   <p ><span class="attr-title ">销售价：</span>￥<span id="stylePrice">@Model.ProductInfo.LowestSalePrice.ToString("F")</span></p>
      if (Model.ProductInfo.SaleStatus == 1 && Model.ProductInfo.SalesType == 1 && ViewBag.IsMultiDepot)
               {
                   //已开启了分仓
                    
                   @Html.Partial("/Areas/MShop/Themes/F1/Views/Partial/_RegoinLayer.cshtml")
               }
    
    
    <div class="choiceOptions c6" id="SKUOptions">
        @Html.Action("OptionSKU", "Product", new { ProductId = Model.ProductInfo.ProductId, SuppId = Model.ProductInfo.SupplierId, viewName = "_OptionSKU" }) 
    </div>
    
    <div class="sku-selected-title mt15 c9" style="min-height: 18px; clear: left; padding-left: 8px;" id="divSelectInfo">
    </div>
    
    <div  class="fooddetail_AddCate" >
        <span>购买数量： </span>
        
        <span class="food-op">
             <span class="reduce-btn" id="subtract" >
                               <button data-inline="true"  class="ui-btn-hidden" data-disabled="false">-</button>
                           </span>
                           <div id="productCount" class="foodnum">
                               1													</div>
                           <span class="add-btn" id="plus" >
                               <button data-inline="true"   class="ui-btn-hidden" data-disabled="false">+</button>
                           </span>
			  
                          
        </span>
       		 <span   id="div_stock"  style="display: none">（库存<span id="stock_num"></span>件）</span>		
 
        
    </div>
  
   <div class="producshow_but">
        <div class="btn-section">
            <span class="btn-tbl-cell">
                <a class="btn-attention link" href="javascript:;"  rel="external"   onclick="productFav(@Model.ProductInfo.ProductId)" >
              
                          <span class="icon">收藏</span></a>
            </span> 
            <span class="btn-tbl-cell" >

                <a class="btn-add-cart link" id="btnAddToCart"   DefaultText='@(YSWL.MALL.BLL.SysManage.ConfigSystem.GetValueByCache("Shop_BuyMode") == "BuyNow" ? "立刻购买" : "放入购物车")'    style="color:#FFF;" itemid=""  productid="@Model.ProductInfo.ProductId">
                    加入购物车</a></span> 
 
        </div>
    </div>  
    
                    @Html.Action("ActivityList", "Partial", new { pId = Model.ProductInfo.ProductId, suppId = Model.ProductInfo.SupplierId }) 
   @Html.Action("WholeSale", new { pId = Model.ProductInfo.ProductId, suppId = Model.ProductInfo.SupplierId })
     <p style="display:none;"><span class="attr-title">积分：</span>@Model.ProductInfo.Points</p>
    <p><span class="attr-title">描述：</span>
     <div   id="imgdetail"> @Html.Raw(Model.ProductInfo.Description)</div> </p>

    <div class="proshowlxtext">
    相关商品</div>
        @Html.Action("ProductRelation", "Product", new { id = Model.ProductInfo.ProductId, Top = 3, viewName = "_ProductRelation" })


    
}



</div>       