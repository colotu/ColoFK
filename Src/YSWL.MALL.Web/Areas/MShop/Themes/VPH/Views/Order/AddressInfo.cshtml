@{
    Layout = "~/Areas/MShop/Themes/VPH/Views/Shared/_BaseLayout.cshtml";
  
}
@section head{
    <link href="/Scripts/jqueryui/red/jquery-ui-1.9.2.min.css" rel="stylesheet" type="text/css" />
    <script src="/Scripts/jquery/jquery.guid.js" type="text/javascript"></script>
}
@model YSWL.MALL.Model.Shop.Shipping.ShippingAddress
<style>
    select {
        height: 30px;
    }
</style>
<header id="header" class="header clearfix">
	    <div class="head_left fl"><a href="javascript:;" onclick="history.go(-1);"><span class="h_back"></span></a></div>
	     <span class="headtit">修改配送地址</span>
	    <div class="head_right fr"><a href="@(ViewBag.BasePath)"><span class="h_home"></span></a></div>
	</header>

<div class="connerdiv">
      @using (Html.BeginForm("SubmitAddressInfo", "Order", FormMethod.Post, new { id = "FormSubmitAddress", area = "MShop" }))
      {
          @Html.HiddenFor(m => m.ShippingId)
                @Html.HiddenFor(m => m.UserId)
        <dl class="connerbox">
            <dd><span>姓名：</span>
                 @Html.TextBoxFor(m => m.ShipName, new { maxlength = "20", @class = "text_input" })
               </dd>
            <dd><span>手机：</span>
             @Html.TextBoxFor(m => m.CelPhone, new { maxlength = "11", @class = "text_input" })
            <dd><span>地区：</span>
              @Html.HiddenFor(m => m.RegionId, new { id = "hfSelectedNode" })
              <script src="/Scripts/jquery/maticsoft.selectregion.js" handle="/RegionHandle.aspx"
                                isnull="true" type="text/javascript"></script>
            </dd>
            <dd><span>邮箱：</span>
                @Html.TextBoxFor(m => m.EmailAddress, new { @class = "text_input" })
            </dd>
        </dl>
          <dl class="connerbox"><dd><span>详情地址：</span>
                  @Html.TextAreaFor(m => m.Address,new{name="address", rows="5", @class="textarea_input textarea_address"})                  
    </dd></dl>
        <div class="ui-btn-area">
            <input type="button" onclick=" Save_Consignee(this) " class="btn_red" data-loading-text="正在提交..." value="完成">
        </div>
    }
</div>
<div class="space10"></div>
          
<script type="text/javascript">
    function Save_Consignee(sender) {
        var shipName = $("#ShipName").val();
        if (shipName == "") {
            ShowFailTip("请填写收货人");
            return;
        }
        var regionId = parseInt($("#hfSelectedNode").val());
        if (regionId == 0 || $("#hfSelectedNode").val() == "") {
            ShowFailTip("请选择所在地区");
            return;
        }
        var address = $("#Address").val();
        if (address == "") {
            ShowFailTip("请填写详细地址");
            return;
        }
        var celPhone = $("#CelPhone").val();
        if (celPhone == "") {
            ShowFailTip("请填写手机号码");
            return;
        }
        $(sender).hide();
        $(sender).next().show();
        var form = $('#FormSubmitAddress');
        $.post(
            form.get(0).action,
            form.serialize(),
            function (data) {
                if (data == "True") {
                    window.location.href = $YSWL.BasePath + "Order/SubmitOrder";
                } else {
                    ShowFailTip("服务器繁忙，请稍候再试！");
                }
                //window.location.hash = "consigneeFocus";
                // Edit_Payment(null, true);
            }
        );
    }
</script>
