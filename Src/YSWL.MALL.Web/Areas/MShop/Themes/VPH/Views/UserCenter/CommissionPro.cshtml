@{
    Layout = "/Areas/MShop/Themes/VPH/Views/Shared/_BaseLayout.cshtml";
    List<YSWL.MALL.Model.Shop.Products.CategoryInfo> CategoryList = ViewBag.CategoryList;
    ViewBag.Title = "个人中心-推广商品";
}
@using Webdiyer.WebControls.Mvc
@model PagedList<YSWL.MALL.ViewModel.Shop.ProComModel> 
<link href="/Areas/MShop/Themes/VPH/Content/Css/UserCenter/userstyle.css" rel="stylesheet"  type="text/css" />

<link href="/Scripts/jqueryui/base/jquery-ui-1.9.2.min.css" rel="stylesheet" type="text/css" />
<script src="/Scripts/jqueryui/jquery-ui-1.9.2.custom.js" type="text/javascript"></script>
<script src="http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function () {
        $(".btnPromo").die().live('click', function () {
            var code = $(this).attr("url");
            $("#PromoLay").find("#txtProName").text($(this).attr("name"));
            $("#PromoLay").find("#txtPromoUrl").text('http://' + $('#hiddomain').val() + '/spread/' + code+'/m');
            var qrUrl = "/tools/qr/gen.aspx?size=200&level=H&content=" + $("#PromoLay").find("#txtPromoUrl").text();
            $("#PromoLay").find("#txtQrCode").attr("src", qrUrl);
            $("#PromoLay").dialog(dialogOpts);
            $(".ui-widget-header").css("border", "none").css("background", "none");
        });
        if ($.getUrlParam("c")) {
            $("#drpProductCategory").val($.getUrlParam("c"));
        }
        if ($.getUrlParam("n")) {
            $("#txtName").val($.getUrlParam("n"));
        }
        $("#btnSearch").click(function () {
            var cid = $("#drpProductCategory").val();
            var name = $("#txtName").val();
            location.href = "@(ViewBag.BasePath)u/CommissionPro?c=" + cid + "&n=" + name;
        });

        //dialog层中项的设置
        var dialogOpts = {
            title: "",
            width: 290,
            height: 430,
            modal: true
        };
    })
</script>
<header id="header" class="header clearfix">
    <div class="head_left fl"><a href="javascript:;" onclick="history.go(-1);"><span class="h_back"></span></a></div>
    <span class="headtit">推广商品</span>
    <div class="head_right fr"><a href="@(ViewBag.BasePath)"><span class="h_home"></span></a></div>

</header>
<div style="padding: 12px">
        商品分类：
           <select id="drpProductCategory" style="height: 28px;  min-width: 100px;max-width: 260px;">
               <option value="0">请选择</option>
               @if (CategoryList != null)
               {
                   foreach (YSWL.MALL.Model.Shop.Products.CategoryInfo item in CategoryList)
                   {
                       <option value="@item.CategoryId">@item.Name</option>
                   }
               }
           </select>
           <br/>
       <div style="padding-top: 8px">
           </div>
           <span style="padding-top: 8px">商品名称</span>：
           <input type="text" name="txtName" id="txtName"   class="text_input"   style="    background-color: white;height: 28px; width: 131px"/>
    &#12288;
    <a href="javascript:;" id="btnSearch" style="display: inline-block;" class="u-btn">搜索</a>
       </div>
@if (Model != null)
{
    <div class="s_links_2 in_user_center">
        @foreach (var item in Model)
        {
        <div class="home_piclist" style="padding: 8px">
            <div class="ddnum1" style="height: auto;">
                <span></span><a href="@(ViewBag.BasePath)Product/Detail/@item.ProductId" target="_blank" style="float: left">
                    <img title="" width="115px" height="115px" src="@YSWL.MALL.Web.Components.FileHelper.GeThumbImage(item.ThumbnailUrl, "T115X115_")" onerror="this.onerror='';this.src='/Content/themes/base/Shop/images/none.png'">
                </a>
                <a href="@(ViewBag.BasePath)Product/Detail/@item.ProductId" target="_blank">
                    @item.ProductName
                </a>
                <br />
                <span>单价：</span>￥@item.ProductPrice.ToString("F")<br />
                <span>比率：</span> <strong style="color: #ff8a00;">@item.FeeRate.ToString("F")%</strong>
                <br />
                <span>佣金：</span>￥@item.FirstFee.ToString("F")<br />
                <span>操作：</span><a style="cursor: pointer" url='@item.PromoCode' class="btnPromo" name="@item.ProductName"><strong>立即推广</strong></a>
                <a style="cursor: pointer" href='/spread/@item.PromoCode/m' name="@item.ProductName">
                    <strong>立即分享</strong>
                </a>
                <br />
            </div>
        </div>
        }
        </div>
        @Html.Pager(Model, new PagerOptions
{
    PageIndexParameterName = "p",
    NumericPagerItemCount = 3,
    NumericPagerItemTemplate = "<p>{0}</p>",
    NavigationPagerItemTemplate = "<p>{0}</p>",
    CssClass = "in_pages_m"
})
        }
        <input type="hidden" value="@(YSWL.Common.Globals.DomainFullName)" id="hiddomain" />
        <div id="PromoLay" style="display: none">
            <div class="user_right" style="float: left">
                <div style="width: 240px; float: left">
                    <h2>
                        专用推广二维码
                    </h2>
                    <p class="user_right_a">
                        这是你的该商品的专用推广二维码，可通过任何方式发送给好友，赶快行动，享受购物拿佣金的乐趣吧！
                    </p>
                    <div class="user_right_b">
                        <div class="user_right_b1" style="width: 240px">
                            <span id="txtProName"></span>
                            <label id="txtPromoUrl" style="display: none">
                            </label>
                        </div>
                        <div class="user_right_b2">
                        </div>
                    </div>
                </div>
                <div style="text-align: center">
                    <img id="txtQrCode" width="150px" height="150px" />
                </div>
                <div class="bdsharebuttonbox">
                    <a href="#" class="bds_more" data-cmd="more"></a><a href="#" class="bds_qzone" data-cmd="qzone"
                                                                        title="分享到QQ空间"></a><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博">
                    </a><a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博"></a><a href="#" class="bds_renren"
                                                                                          data-cmd="renren" title="分享到人人网"></a><a href="#" class="bds_weixin" data-cmd="weixin"
                                                                                                                                  title="分享到微信"></a>
                </div>
                <script type="text/javascript">
                    window._bd_share_config = {
                        "common": {
                            "bdSnsKey": {
                            },
                            "bdText": "",

                            "bdMini": "2",
                            "bdMiniList": false,
                            "bdStyle": "0",
                            "bdSize": "32",
                            "onBeforeClick": function (cmd, config) {
                                config.bdText = $("#PromoLay").find("#txtProName").text();
                                config.bdUrl = $("#PromoLay").find("#txtPromoUrl").text();
                                config.bdPic = "http://@(YSWL.Common.Globals.DomainFullName)" + $("#PromoLay").find("#txtQrCode").attr("src");
                                return config;
                            }
                        },
                        "share": {

                        },
                        "image": {
                            "viewList": [
                    "qzone",
                    "tsina",
                    "tqq",
                    "renren",
                    "weixin"
                            ],
                            "viewText": "分享到：",
                            "viewSize": "16"
                        },
                        "selectShare": {
                            "bdContainerClass": null,
                            "bdSelectMiniList": [
                    "qzone",
                    "tsina",
                    "tqq",
                    "renren",
                    "weixin"
                            ]
                        }
                    }; </script>
                <div class="clear">
                </div>
            </div>
        </div>
