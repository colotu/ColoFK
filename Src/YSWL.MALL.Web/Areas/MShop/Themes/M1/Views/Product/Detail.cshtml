@{
    Layout = "/Areas/MShop/Themes/M1/Views/Shared/_BaseLayout.cshtml";

}
@using YSWL.MALL.Model.Shop.Products
@model YSWL.MALL.ViewModel.Shop.ProductModel
<script type="text/javascript">    var Shop_BuyMode = '@YSWL.MALL.BLL.SysManage.ConfigSystem.GetValueByCache("Shop_BuyMode")';</script>
<link href="/Scripts/PhotoSwipe/photoswipe.css" rel="stylesheet" type="text/css" />
<script src="/Scripts/PhotoSwipe/klass.min.js" type="text/javascript"></script>
<script src="/Scripts/jquery/maticsoft.jquery.min.js" type="text/javascript"></script>
<script src="/Scripts/jquery/maticsoft.img.min.js" type="text/javascript"></script>
<link href="/Areas/MShop/Themes/M1/Content/Css/productdetail.css" rel="stylesheet"  type="text/css" />
<link href="/Scripts/jqueryui/base/jquery-ui-1.9.2.min.css" rel="stylesheet" type="text/css" />
<script src="/Scripts/jqueryui/jquery-ui-1.9.2.custom.js" type="text/javascript"></script>
<script src="/Areas/MShop/Themes/M1/Content/Scripts/productdetail.js" type="text/javascript"></script>
<script src="/Areas/MShop/Themes/M1/Content/Scripts/SKU.js" type="text/javascript"></script>
<script src="/Scripts/PhotoSwipe/photoswipe.jquery.min.js" type="text/javascript"></script>
<script src="/Scripts/jquery.cookie.js" type="text/javascript"></script>
<script type="text/javascript">
    pagename = "product_detail";
    $(function() {
        var myPhotoSwipe = $(".view-photo a").photoSwipe({
            enableMouseWheel: true,
            enableKeyboard: true,
            autoStartSlideshow: true,
            captionAndToolbarOpacity: 1
        });

        if (@Model.ProductInfo.SalesType == 3) {
            $('#btnAddToCart').attr('disabled', 'disabled').addClass('addCart-gray').text('赠品不出售!').attr('itemid', '');
            $('#iteminfo #divBuyInfo').hide();
            $('#iteminfo #divSelectInfo').empty();
        }
        if (@Model.ProductInfo.SaleStatus !== 1) {
            $('#btnAddToCart').attr('disabled', 'disabled').addClass('addCart-gray').text('非常抱歉, 此商品已下架!').attr('itemid', '');
            $('#iteminfo #divBuyInfo').hide();
            $('#iteminfo #divSelectInfo').empty();
        }
        if ("@ViewBag.Spread"== "True") {
            $(".guid-share").show();
        }
        $(".guid-share").click(function() {
            $(this).hide();
        });

    });

</script>
<style type="text/css">
 
  
    </style>
<div class="top">
    <a href="javascript:;" onclick="history.go(-1)"><span>&lt;返回</span></a>
    @Html.Partial("/Areas/MShop/Themes/M1/Views/Partial/_HeadRight.cshtml")
</div>
<div class="guid-share" style="display: none">
    <img  style="width: 100%; " src="/Areas/MShop/Themes/M1/Content/images/guidShare.png" alt="@Model.ProductInfo.ProductName" />
</div>
@if (Model != null)
{
    <div id="iteminfo" data-role="page" data-add-back-btn="true">
    <input id="hdProductId" type="hidden"  value="@Model.ProductInfo.ProductId"/>
    <input id="hdsuppId"   type="hidden" value="@Model.ProductInfo.SupplierId"/>
        <div class="productshow_title">
            @Model.ProductInfo.ProductName</div>
        <div class="view-photo tc">
            @* <a href="javascript:void(0)" id="i_pre" class="btn-prev">上一个</a> *@ @*            <li class="mid-img" id="div_img"><a href="@YSWL.MALL.Web.Components.FileHelper.GeThumbImage(Model.ProductInfo.ThumbnailUrl1, "T300X390_")"  rel="external" >
                <img  src="@YSWL.MALL.Web.Components.FileHelper.GeThumbImage(Model.ProductInfo.ThumbnailUrl1, "T175X228_")"  alt="@Model.ProductInfo.ProductName" />
            </a>
                <br />
            </li>*@
            @if (Model != null && Model.ProductImages != null)
            {
                foreach (ProductImage productImage in Model.ProductImages)
                {
        
                <li class="mid-img " style="@(productImage.ThumbnailUrl1 == Model.ProductInfo.ThumbnailUrl1 ? "" : "display:none")">
                    <a href="@YSWL.MALL.Web.Components.FileHelper.GeThumbImage(productImage.ThumbnailUrl1, "T300X390_")" rel="external" >
                        <img item="@YSWL.MALL.Web.Components.FileHelper.GeThumbImage(productImage.ThumbnailUrl1, "T175X228_")"  src="@YSWL.MALL.Web.Components.FileHelper.GeThumbImage(productImage.ThumbnailUrl1, "T175X228_")"   alt="@Model.ProductInfo.ProductName" />
                    </a></li>

                }
            }
        </div>
        @*     <a id="i_next" href="javascript:void(0)" class="btn-next">下一个</a>*@
        @Html.Action("StoreLayer", "Partial", new { suppId = Model.ProductInfo.SupplierId })
        <div class="productshow_jiage">
            市场价：<span>￥@(Model.ProductInfo.MarketPrice.HasValue ? Model.ProductInfo.MarketPrice.Value.ToString("F") : "0")</span><br />
            销售价：<strong>￥<span id="stylePrice">  @if (Model.ProductSkus != null && Model.ProductSkus.Count > 0)
                                                 { 
                                                 @Model.ProductSkus[0].SalePrice.ToString("F")
                                                 }</span></strong>
            @if (Model.ProductSkus != null && Model.ProductSkus.Count > 0 && Model.ProductSkus[0].RankPrice > 0)
            {
                <div>会员价：<strong>￥<span id="rankPrice">@Model.ProductSkus[0].RankPrice.ToString("F")</span></strong></div>
            }
               @if (Model.ProductInfo.SaleStatus == 1 && Model.ProductInfo.SalesType == 1 && ViewBag.IsMultiDepot)
               {
                   //已开启了分仓
                    
                   @Html.Partial("/Areas/MShop/Themes/M1/Views/Partial/_RegoinLayer.cshtml")
               }
        </div>
        <div class="proshow_pl">
            @*<a href="@(ViewBag.BasePath)product/Comments/@Model.ProductInfo.ProductId"><small>商品评论：</small> （@ViewBag.CommentCount）</a>*@</div>
        <div class="choiceOptions c6">
            <div id="SKUOptions" class="proshowlxtext  " style="float: left">
                @Html.Action("OptionSKU", "Product", new { ProductId = Model.ProductInfo.ProductId, SuppId = Model.ProductInfo.SupplierId, viewName = "_OptionSKU" })
            </div>
        </div>
        <div class="sku-selected-title mt15 c9" style="min-height: 18px; clear: left; padding-left: 8px;"
            id="divSelectInfo">
        </div>
        <div class="productshow_sl" id="divBuyInfo">
            购买件数：<a href="javascript:;" class="redu" id="subtract">-</a>
            <input type="text" size="4" value="1" name="num" id="productCount" class="common-input" />
            <a href="javascript:;" id="plus" class="add">+</a> </div>
                <div   id="div_stock" style="display:none;margin: 13px 0 0px 0;">（库存<span id="stock_num"></span>件）</div>
        <div class="producshow_but">
            <div class="btn-section">
                <span class="btn-tbl-cell"><a class="btn-attention link" productId="@Model.ProductInfo.ProductId" id="btnProductFav">
                    <span class="icon">关注</span></a></span> <span class="btn-tbl-cell"><a class="btn-add-cart link" id="btnAddToCart" DefaultText='@(YSWL.MALL.BLL.SysManage.ConfigSystem.GetValueByCache("Shop_BuyMode") == "BuyNow" ? "立刻购买" : "放入购物车")'   itemid=""  productid="@Model.ProductInfo.ProductId">
                        @(YSWL.MALL.BLL.SysManage.ConfigSystem.GetValueByCache("Shop_BuyMode") == "BuyNow" ? "立刻购买" : "放入购物车")</a></span>
                <span class="btn-tbl-cell" style="display: none"><a class="btn-quk-buy" id="btnQukBuy"   itemid=""  productid="@Model.ProductInfo.ProductId">
                    立刻购买</a></span>
            </div>
        </div>
    </div>
}
@Html.Action("ActivityList", "Partial", new { pId = Model.ProductInfo.ProductId, suppId = Model.ProductInfo.SupplierId }) 
@Html.Action("WholeSale", new { pId = Model.ProductInfo.ProductId, suppId = Model.ProductInfo.SupplierId })
<div class="productshow_a">
    <ul>
        <li><a href="@(ViewBag.BasePath)product/productdesc/@Model.ProductInfo.ProductId">商品详情</a></li>
        <li style="display: none"><a href="@(ViewBag.BasePath)product/Consults/@Model.ProductInfo.ProductId">
            商品咨询</a></li>
    </ul>
</div>
<div class="proshowlxtext">
    相关商品</div>
@Html.Action("ProductRelation", "Product", new { id = Model.ProductInfo.ProductId, Top = 3, viewName = "_ProductRelation" })

 